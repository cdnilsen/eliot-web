<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Synapdeck</title>
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./synapdeck_styles.css">

</head>
<body>
    <div class="container">
        <h1>Welcome to Synapdeck!</h1>
        <div class="button-row">
            <button type="button" id="upload_cards" class="active">Upload Card Data</button>
            <button type="button" id="browse_cards">Browse Cards</button>
            <button type="button" id="review_cards">Do Reviews</button>
            <button type="button" id="check_work">Check Your Work</button>
        </div>

        <div id="upload_mainDiv" class="tab-content active">
            <h2>Upload Cards</h2>
            <!-- Radio button selection for input method -->
            <div class="input-method-selection">
                <h3>Choose input method:</h3>
                <div class="radio-buttons-row">
                    <label>
                        <input type="radio" name="inputMethod" value="file" id="fileInputRadio" checked>
                        Upload from file
                    </label>
                    <label>
                        <input type="radio" name="inputMethod" value="text" id="textInputRadio">
                        Type cards directly
                    </label>
                </div>
            </div>

            <div class="input-method-selection">
                <h3>Choose Transcription System:</h3>
                <div class="radio-buttons-row">
                    <label>
                        <input type="radio" name="romanization_selection" value="diacritics" id="romanization_diacritics" checked>
                        With diacritics (e.g. <i>mäšäggər</i>, <i>gädām</i>, <i>bäṣḥä</i>)
                    </label>
                    <label>
                        <input type="radio" name="romanization_selection" value="ascii" id="romanization_ascii">
                        ASCII (e.g. <i>macaggEr</i>, <i>gadAm</i>, <i>baSHa</i>)
                    </label>
                </div>
            </div>

            <label for="upload_dropdownMenu">Choose a deck:</label>
            <select id="upload_dropdownMenu" name="upload_dropdownMenu">
                <option value="" disabled selected>(None)</option>
                <option value="Ge'ez">Ge'ez</option>
                <option value="Sanskrit">Sanskrit</option>
            </select>

            <div id="cardFormatSection">
                <label for="card_format_dropdown">Choose card type (more coming soon):</label>
                <select id="card_format_dropdown" name="card_type_dropdown">
                    <option value="two-way">Two-way card</option>
                    <option value="one-way-T2N">One-way (Target to Native)</option>
                    <option value="one-way-N2T">One-way (Native to Target)</option>
                </select>
            </div>
            
            <!-- File upload section -->
            <div class="upload_input-group" id="fileUploadSection">
                <label for="uploadTextFile">Upload Text File:</label>
                <input type="file" id="uploadTextFile" accept=".txt">
            </div>

            <!-- Text input section -->
            <div class="text_input-group" id="textInputSection" style="display: none;">
                <label for="cardTextInput">Type your cards (follow the format examples above):</label>
                <textarea id="cardTextInput" rows="10" cols="50" placeholder="Enter your cards here following the format:&#10;näbärä / to sit / näbärä&#10;hägär / city / hägär"></textarea>
            </div>
            
            <div class="button-group">
                <button id="upload_submitBtn" class="hidden">Submit</button>
                <button id="upload_cancel" class="hidden">Cancel</button>
            </div>
            <br>
            <br>
            <div class="review-options">
                <button type="button" id="wipeDatabaseButton" style="background: red; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer;">
                    &#10003; Wipe the database
                </button>
            </div>
            
            <div id="upload_output"></div>
        </div>

        <!-- Add placeholder divs for other tabs -->
        <div id="browse_mainDiv" class="tab-content">
            <h2>Browse Cards</h2>
            <p>Browse cards content will go here...</p>
        </div>

        <div id="review_mainDiv" class="tab-content">
            <label for="review_dropdownMenu">Choose a deck to review:</label>
            <select id="review_dropdownMenu" name="review_dropdownMenu">
                <option value="" disabled selected>Select a deck</option>
                <option value="Ge'ez">Ge'ez</option>
                <option value="Sanskrit">Sanskrit</option>
            </select>

            <div class="review_input-group">
                <label for="review_numCards">Number of new cards to review:</label>
                <input type="number" id="review_numCards" name="review_numCards" min="1" max="100" value="10">
            </div>

            <div class="review-options">
            <label>
                <input type="checkbox" id="reviewAheadCheckbox" />
                Review cards ahead of schedule
            </label>
            <div id="reviewAheadOptions" style="display: none; margin-left: 20px;">
                <label>
                    Review cards due within: 
                    <select id="reviewAheadHours">
                        <option value="6">6 hours</option>
                        <option value="12">12 hours</option>
                        <option value="24" selected>24 hours</option>
                        <option value="48">48 hours</option>
                        <option value="72">72 hours</option>
                        <option value="168">1 week</option>
                    </select>
                </label>
            </div>

            <button id="review_submitBtn">Submit</button>

            <div class="review-options">
                <button type="button" id="resetCardReview" style="background: #00ffff; color: black; border: 3px black; padding: 8px 12px; border-radius: 4px; cursor: pointer;">
                    &#10003; Reset all cards' review status
                </button>
            </div>
        </div>
    </div>

        <div id="check_mainDiv" class="tab-content">
            <h2>Check Your Work</h2>
            <p>View answer keys for cards currently under review.</p>
            
            <label for="check_dropdownMenu">Choose a deck to check:</label>
            <select id="check_dropdownMenu" name="check_dropdownMenu">
                <option value="" disabled selected>Select a deck</option>
                <option value="Ge'ez">Ge'ez</option>
                <option value="Sanskrit">Sanskrit</option>
            </select>

            <div class="check_input-group">
                <button id="check_submitBtn">Show Answer Key</button>
            </div>

            <div id="check_output">Select a deck and click "Show Answer Key" to see answers for cards currently under review.</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.1/jspdf.umd.min.js"></script>
    <script>
        // Make jsPDF available to your module
        window.jsPDF = window.jspdf.jsPDF;
        console.log('jsPDF available:', typeof window.jsPDF);

        // Handle radio button changes to show/hide appropriate input sections
        document.addEventListener('DOMContentLoaded', function() {
            const fileRadio = document.getElementById('fileInputRadio');
            const textRadio = document.getElementById('textInputRadio');
            const fileSection = document.getElementById('fileUploadSection');
            const textSection = document.getElementById('textInputSection');
            const submitBtn = document.getElementById('upload_submitBtn');
            const cancelBtn = document.getElementById('upload_cancel');

            function toggleInputSections() {
                if (fileRadio.checked) {
                    fileSection.style.display = 'block';
                    textSection.style.display = 'none';
                } else if (textRadio.checked) {
                    fileSection.style.display = 'none';
                    textSection.style.display = 'block';
                }
                
                // Show submit and cancel buttons when either input method is selected
                if (fileRadio.checked || textRadio.checked) {
                    submitBtn.classList.remove('hidden');
                    cancelBtn.classList.remove('hidden');
                }
            }

            fileRadio.addEventListener('change', toggleInputSections);
            textRadio.addEventListener('change', toggleInputSections);

            // Initialize the display
            toggleInputSections();
        });
        
        import('./synapdeck.js')
            .then(() => {
                console.log('synapdeck.js loaded successfully');
            })
            .catch(error => {
                console.error('Failed to load synapdeck.js:', error);
            });
    </script>
</body>
</html>